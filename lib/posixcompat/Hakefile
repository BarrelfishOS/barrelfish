--------------------------------------------------------------------------
-- Copyright (c) 2007-2009, 2011, 2012, 2013, 2014, ETH Zurich.
-- All rights reserved.
--
-- This file is distributed under the terms in the attached LICENSE file.
-- If you do not find this file, copies can be found by writing to:
-- ETH Zurich D-INFK, CAB F.78, Universitaetstr. 6, CH-8092 Zurich,
-- Attn: Systems Group.
--
-- Hakefile for lib/posixcompat
--
--------------------------------------------------------------------------

let cFiles = [ "access.c",
               "alarm.c",
               "basename.c",
               "chdir.c",
               "chmod.c",
               "chroot.c",
               "close.c",
               "creat.c",
               "dirent.c",
               "dirname.c",
               "dlfcn.c",
               "dup.c",
               "_exit.c",
               "fcntl.c",
               "fstat.c",
               "fsync.c",
               "ftruncate.c",
               "getcwd.c",
               "geteuid.c",
               "getgroups.c",
               "gethostid.c",
               "gethostname.c",
               "getpid.c",
               "getpwent.c",
               "grp.c",
               "inheritance.c",
               "getpagesize.c",
               "ioctl.c",
               "isatty.c",
               "kill.c",
               "link.c",
               "lseek.c",
               "mmap.c",
               "mkdir.c",
               "open.c",
               "pipe.c",
               "popen.c",
               "pty.c",
               "random.c",
               "read.c",
               "readlink.c",
               "readv.c",
               "remove.c",
               "rename.c",
               "rmdir.c",
               "sbrk.c",
               "select.c",
               "semaphore.c",
               "setitimer.c",
               "setsid.c",
               "shm.c",
               "signal.c",
               "sockets.c",
               "stat.c",
               "sysconf.c",
               "termios.c",
               "time.c",
               "timegm.c",
               "ttyname.c",
               "umask.c",
               "unlink.c",
               "utime.c",
               "wait.c",
               "write.c",
               "mkfifo.c",
               "setrlimit.c",
               "pthreads.c",
               "sleep.c",
               "epoll.c",
               "poll.c",
               "inet_ntop.c",
               "inet_pton.c",
               "uname.c" ]
in
[ build library {
        target = "posixcompat",
        cFiles = cFiles,
        flounderDefs = [ "unixsock", "octopus", "monitor", "terminal", "terminal_config", "terminal_session" ],
        flounderBindings = [ "unixsock", "octopus" ],
        flounderExtraBindings = [ ("octopus", [ "rpcclient" ]) ],
        flounderTHCStubs = [ "octopus" ],
        addLibraries = libDeps [ "vfs_nonfs",  "term_server", "octopus", "lwip" ],
        architectures = [ "x86_64" ]
    },
    build library {
        target = "posixcompat",
        cFiles = cFiles,
        flounderDefs = [ "unixsock", "octopus", "monitor", "terminal", "terminal_config", "terminal_session" ],
        flounderBindings = [ "unixsock", "octopus" ],
        flounderExtraBindings = [ ("octopus", [ "rpcclient" ]) ],
        flounderTHCStubs = [ "octopus" ],
        addLibraries = libDeps [ "vfs_ramfs",  "term_server", "octopus", "lwip" ],
        architectures = [ "x86_32", "k1om", "armv7", "armv8" ]
    }
]
